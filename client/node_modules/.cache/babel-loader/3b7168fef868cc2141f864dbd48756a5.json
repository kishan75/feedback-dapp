{"ast":null,"code":"import _defineProperty from \"F:\\\\BlockChain\\\\Projects\\\\feedback-dapp\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"F:\\\\BlockChain\\\\Projects\\\\feedback-dapp\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"F:\\\\BlockChain\\\\Projects\\\\feedback-dapp\\\\client\\\\src\\\\components\\\\Modals\\\\ProfessorDetails\\\\professorDetails.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport ProfessorDetailsFunctionBox from '../../FunctionBox/ProfessorDetailsFunctionBox/professorDetailsFunctionBox';\nimport \"./professorDetails.css\";\n\nconst ProfessorDetails = props => {\n  const _useState = useState({\n    address: props.account,\n    ticket: '',\n    name: 'Dr. ',\n    email: '',\n    file: ''\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        professorDetails = _useState2[0],\n        setProfessorDetails = _useState2[1];\n\n  const _useState3 = useState({\n    address: '',\n    ticket: '',\n    name: '',\n    email: '',\n    file: ''\n  }),\n        _useState4 = _slicedToArray(_useState3, 2),\n        professorErrors = _useState4[0],\n        setProfessorErrors = _useState4[1]; // Asyncs:\n\n\n  const writeToBlockChain = async () => {\n    const feedbackData = props.contracts.feedbackData;\n\n    if (feedbackData != undefined) {\n      let result = await feedbackData.methods.createProfessor(professorDetails.name, professorDetails.email, '', professorDetails.ticket).send({\n        from: professorDetails.address\n      });\n      console.log(result);\n      return result;\n    } else {\n      props.onToastChange('INTERNAL-ERROR: Contract not deployed', 'error', true);\n      console.log('Feedback contract not deployed');\n    }\n  }; // Handlers\n\n\n  const handleProfessorInputChange = event => {\n    setProfessorDetails(_objectSpread({}, professorDetails, {\n      [event.target.name]: event.target.value\n    }));\n\n    let updatedErrors = _objectSpread({}, professorErrors);\n\n    updatedErrors = validateProfessorInput(event.target.name, event.target.value, updatedErrors);\n    setProfessorErrors(_objectSpread({}, updatedErrors));\n  };\n\n  const handlerProfessorSubmit = () => {\n    let updatedErrors = _objectSpread({}, professorErrors);\n\n    for (var key in professorDetails) if (professorDetails.hasOwnProperty(key)) updatedErrors = validateProfessorInput(key, professorDetails[key], updatedErrors);\n\n    setProfessorErrors(_objectSpread({}, updatedErrors));\n\n    const fastProfessorErrors = _objectSpread({}, updatedErrors);\n\n    let ready = true;\n\n    for (var key in fastProfessorErrors) {\n      if (fastProfessorErrors.hasOwnProperty(key)) if (fastProfessorErrors[key] != '') ready = false;\n    }\n\n    console.log('Ready:', ready);\n    console.log(professorDetails);\n\n    if (ready) {\n      writeToBlockChain().then(r => {\n        console.log(r);\n        props.onToastChange('TxN SUCCESS: You have been registered', 'success', true);\n        setTimeout(() => props.closeModal(), 3500);\n      }).catch(e => {\n        if (e.code == 'INVALID_ARGUMENT') props.onToastChange('ERROR: Ticket should be in hex', 'error', true);else if (e.code == '4001') props.onToastChange('TxN WARN: Denied by user', 'warning', true);else props.onToastChange('TxN ERROR: Invalid ticket', 'error', true);\n      });\n    }\n  };\n\n  const convertBase64 = file => {\n    return new Promise((resolve, reject) => {\n      const fileReader = new FileReader();\n      fileReader.readAsDataURL(file);\n\n      fileReader.onload = () => {\n        resolve(fileReader.result);\n      };\n\n      fileReader.onerror = error => {\n        console.log(error);\n        reject(error);\n      };\n    });\n  };\n\n  const handleImageFileUpload = async e => {\n    switch (e.target.name) {\n      case 'pic':\n        // const file = e.target.files[0];\n        // const base64 = await convertBase64(file)\n        // console.log(base64);\n        const data = new FormData();\n        data.append(\"image\", e.target.files[0]);\n        data.append(\"address\", professorDetails.address);\n        const config = {\n          headers: {\n            \"Content-type\": 'multipart/form-data'\n          }\n        };\n        axios.post(\"http://127.0.0.1:5001/upload\", data, config).then(res => {\n          console.log(res);\n          setProfessorDetails(_objectSpread({}, professorDetails, {\n            file: e.target.files[0]\n          }));\n        }).catch(err => {\n          setToast({\n            message: 'UPLOAD ERROR: Something went wrong or already uploaded with current account',\n            severity: 'error',\n            open: true\n          });\n          console.log(err);\n        });\n        break;\n\n      default:\n        console.error('Error while uploading file');\n        break;\n    }\n  }; // Validators\n\n\n  const validateProfessorInput = (field, value, updatedErrors) => {\n    switch (field) {\n      case 'name':\n        if (value.length == 0) updatedErrors[field] = 'Cannot be empty';else if (value.length < 5) updatedErrors[field] = 'Length should be greater than 5';else if (value.length > 30) updatedErrors[field] = 'Length should be smaller than 30';else updatedErrors[field] = '';\n        break;\n\n      case 'ticket':\n      case 'address':\n        if (value.length == 0) updatedErrors[field] = 'Cannot be empty';else if (value.length < 10) updatedErrors[field] = 'Length should be greater than 10';else if (value.length > 100) updatedErrors[field] = 'Length should be smaller than 100';else updatedErrors[field] = '';\n        break;\n\n      case 'email':\n        var re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        if (value.length == 0) updatedErrors[field] = 'Cannot be empty';else if (!re.test(value)) updatedErrors[field] = 'Invalid email!';else if (!(value.endsWith('@itbhu.ac.in') || value.endsWith('@iitbhu.ac.in'))) updatedErrors[field] = 'Invalid domain, accepted domains are @itbhu.ac.in or @iitbhu.ac.in';else updatedErrors[field] = '';\n        break;\n\n      case 'file':\n        if (value.length == 0) updatedErrors[field] = 'Must upload display picture';else updatedErrors[field] = '';\n        break;\n    }\n\n    return updatedErrors;\n  };\n\n  return React.createElement(\"div\", {\n    className: \"cards\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, React.createElement(ProfessorDetailsFunctionBox, {\n    data: professorDetails,\n    errors: professorErrors,\n    handleInputChange: handleProfessorInputChange,\n    handleSubmit: handlerProfessorSubmit,\n    handleFileChange: handleImageFileUpload,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }));\n};\n\nexport default ProfessorDetails;","map":{"version":3,"sources":["F:/BlockChain/Projects/feedback-dapp/client/src/components/Modals/ProfessorDetails/professorDetails.js"],"names":["React","useState","axios","ProfessorDetailsFunctionBox","ProfessorDetails","props","address","account","ticket","name","email","file","professorDetails","setProfessorDetails","professorErrors","setProfessorErrors","writeToBlockChain","feedbackData","contracts","undefined","result","methods","createProfessor","send","from","console","log","onToastChange","handleProfessorInputChange","event","target","value","updatedErrors","validateProfessorInput","handlerProfessorSubmit","key","hasOwnProperty","fastProfessorErrors","ready","then","r","setTimeout","closeModal","catch","e","code","convertBase64","Promise","resolve","reject","fileReader","FileReader","readAsDataURL","onload","onerror","error","handleImageFileUpload","data","FormData","append","files","config","headers","post","res","err","setToast","message","severity","open","field","length","re","test","endsWith"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport ProfessorDetailsFunctionBox from '../../FunctionBox/ProfessorDetailsFunctionBox/professorDetailsFunctionBox';\r\n\r\nimport \"./professorDetails.css\";\r\n\r\n\r\nconst ProfessorDetails = (props) => {\r\n  const [professorDetails, setProfessorDetails] = useState({\r\n    address: props.account,\r\n    ticket: '',\r\n    name: 'Dr. ',\r\n    email: '',\r\n    file: '',\r\n  });\r\n\r\n  const [professorErrors, setProfessorErrors] = useState({\r\n    address: '',\r\n    ticket: '',\r\n    name: '',\r\n    email: '',\r\n    file: '',\r\n  })\r\n\r\n  // Asyncs:\r\n  const writeToBlockChain = async () => {\r\n    const feedbackData = props.contracts.feedbackData;\r\n    if (feedbackData != undefined) {\r\n      let result = await feedbackData.methods.createProfessor(professorDetails.name, professorDetails.email, '', professorDetails.ticket).send({ from: professorDetails.address });\r\n      console.log(result);\r\n      return result\r\n    } else {\r\n      props.onToastChange('INTERNAL-ERROR: Contract not deployed', 'error', true);\r\n      console.log('Feedback contract not deployed');\r\n    }\r\n  }\r\n\r\n\r\n  // Handlers\r\n  const handleProfessorInputChange = (event) => {\r\n    setProfessorDetails({\r\n      ...professorDetails,\r\n      [event.target.name]: event.target.value\r\n    });\r\n\r\n    let updatedErrors = { ...professorErrors };\r\n    updatedErrors = validateProfessorInput(event.target.name, event.target.value, updatedErrors);\r\n    setProfessorErrors({ ...updatedErrors });\r\n  };\r\n\r\n\r\n  const handlerProfessorSubmit = () => {\r\n    let updatedErrors = { ...professorErrors };\r\n\r\n    for (var key in professorDetails)\r\n      if (professorDetails.hasOwnProperty(key))\r\n        updatedErrors = validateProfessorInput(key, professorDetails[key], updatedErrors);\r\n\r\n    setProfessorErrors({ ...updatedErrors });\r\n    const fastProfessorErrors = { ...updatedErrors };\r\n\r\n    let ready = true;\r\n    for (var key in fastProfessorErrors) {\r\n      if (fastProfessorErrors.hasOwnProperty(key))\r\n        if (fastProfessorErrors[key] != '')\r\n          ready = false;\r\n    }\r\n\r\n    console.log('Ready:', ready);\r\n    console.log(professorDetails);\r\n\r\n    if (ready) {\r\n      writeToBlockChain()\r\n        .then(r => {\r\n          console.log(r);\r\n          props.onToastChange('TxN SUCCESS: You have been registered', 'success', true);\r\n          setTimeout(() => props.closeModal(), 3500);\r\n        }\r\n        ).catch(e => {\r\n          if (e.code == 'INVALID_ARGUMENT')\r\n            props.onToastChange('ERROR: Ticket should be in hex', 'error', true);\r\n          else if (e.code == '4001')\r\n            props.onToastChange('TxN WARN: Denied by user', 'warning', true);\r\n          else\r\n            props.onToastChange('TxN ERROR: Invalid ticket', 'error', true);\r\n        })\r\n    }\r\n  }\r\n\r\n  const convertBase64 = (file) => {\r\n    return new Promise((resolve, reject) => {\r\n      const fileReader = new FileReader();\r\n      fileReader.readAsDataURL(file)\r\n      fileReader.onload = () => {\r\n        resolve(fileReader.result);\r\n      }\r\n      fileReader.onerror = (error) => {\r\n        console.log(error);\r\n        reject(error);\r\n      }\r\n    })\r\n  }\r\n\r\n  const handleImageFileUpload = async (e) => {\r\n    switch (e.target.name) {\r\n      case 'pic':\r\n        // const file = e.target.files[0];\r\n        // const base64 = await convertBase64(file)\r\n        // console.log(base64);\r\n\r\n        const data = new FormData();\r\n        data.append(\"image\", e.target.files[0]);\r\n        data.append(\"address\", professorDetails.address);\r\n        const config = {\r\n          headers: {\r\n            \"Content-type\": 'multipart/form-data',\r\n          },\r\n        };\r\n        axios.post(\"http://127.0.0.1:5001/upload\", data, config)\r\n          .then(res => {\r\n            console.log(res)\r\n\r\n            setProfessorDetails({\r\n              ...professorDetails,\r\n              file: e.target.files[0]\r\n            });\r\n          })\r\n          .catch(err => {\r\n            setToast({ message: 'UPLOAD ERROR: Something went wrong or already uploaded with current account', severity: 'error', open: true });\r\n            console.log(err)\r\n          });\r\n\r\n        break;\r\n      default:\r\n        console.error('Error while uploading file'); break;\r\n    }\r\n  }\r\n\r\n\r\n  // Validators\r\n  const validateProfessorInput = (field, value, updatedErrors) => {\r\n    switch (field) {\r\n      case 'name':\r\n        if (value.length == 0)\r\n          updatedErrors[field] = 'Cannot be empty';\r\n        else if (value.length < 5)\r\n          updatedErrors[field] = 'Length should be greater than 5';\r\n        else if (value.length > 30)\r\n          updatedErrors[field] = 'Length should be smaller than 30';\r\n        else\r\n          updatedErrors[field] = ''\r\n        break;\r\n      case 'ticket':\r\n      case 'address':\r\n        if (value.length == 0)\r\n          updatedErrors[field] = 'Cannot be empty';\r\n        else if (value.length < 10)\r\n          updatedErrors[field] = 'Length should be greater than 10';\r\n        else if (value.length > 100)\r\n          updatedErrors[field] = 'Length should be smaller than 100';\r\n        else\r\n          updatedErrors[field] = ''\r\n        break;\r\n      case 'email':\r\n        var re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n        if (value.length == 0)\r\n          updatedErrors[field] = 'Cannot be empty';\r\n        else if (!re.test(value))\r\n          updatedErrors[field] = 'Invalid email!';\r\n        else if (!(value.endsWith('@itbhu.ac.in') || value.endsWith('@iitbhu.ac.in')))\r\n          updatedErrors[field] = 'Invalid domain, accepted domains are @itbhu.ac.in or @iitbhu.ac.in';\r\n        else\r\n          updatedErrors[field] = ''\r\n        break;\r\n      case 'file':\r\n        if (value.length == 0)\r\n          updatedErrors[field] = 'Must upload display picture';\r\n        else\r\n          updatedErrors[field] = ''\r\n        break\r\n    }\r\n    return updatedErrors;\r\n  }\r\n\r\n\r\n  return (\r\n    <div className='cards'>\r\n      <ProfessorDetailsFunctionBox\r\n        data={professorDetails}\r\n        errors={professorErrors}\r\n        handleInputChange={handleProfessorInputChange}\r\n        handleSubmit={handlerProfessorSubmit}\r\n        handleFileChange={handleImageFileUpload}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProfessorDetails;"]},"metadata":{},"sourceType":"module"}